import{ac as y,h as c,ae as h,af as t,aj as p,ag as a,aw as S,ah as d,c as f,ap as k,aq as D,W as M,ai as m,ar as I,f as w,ak as b}from"./index.97bff0c1.js";import{Q as u}from"./QItemLabel.c7948ba6.js";import{Q as C,a as Q,b as g}from"./QList.f9691a2b.js";import{Q as _}from"./QPage.e87dc99e.js";const N={name:"ProfilePage",data(){return{showToFind:"",shows:[],myShowIDs:[]}},watch:{showToFind(){this.getTVShows(this.showToFind)}},mounted(){sessionStorage.getItem("loggedIn")==="false"?(console.log("Not logged in, redirecting to login page"),this.$router.push("/login")):(console.log("Logged in, getting my shows"),this.getMyShowIDs())},methods:{myShows(){this.$router.push("/my-shows")},getTVShows(o){console.log("In getTVShows");const e="24c87807-e9cd-4e9c-8d19-28ef0f44d186",l="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJhZ2UiOiIiLCJhcGlrZXkiOiIyNGM4NzgwNy1lOWNkLTRlOWMtOGQxOS0yOGVmMGY0NGQxODYiLCJjb21tdW5pdHlfc3VwcG9ydGVkIjp0cnVlLCJleHAiOjE3MDcyMjUwNDEsImdlbmRlciI6IiIsImhpdHNfcGVyX2RheSI6MTAwMDAwMDAwLCJoaXRzX3Blcl9tb250aCI6MTAwMDAwMDAwLCJpZCI6IjIzMTYyMjEiLCJpc19tb2QiOmZhbHNlLCJpc19zeXN0ZW1fa2V5IjpmYWxzZSwiaXNfdHJ1c3RlZCI6ZmFsc2UsInBpbiI6IlZLR0dPUVNFIiwicm9sZXMiOltdLCJ0ZW5hbnQiOiJ0dmRiIiwidXVpZCI6IiJ9.FJ0BhZb_rKQaidR-M5MzznSeYSYZ7kCeRwNLcnQk4TSiU-YMzThnboaU3Lbtr1F6d54jk9taWzrAoXOoSKFdEP2Z86Qim-fbJHl8sWBOYphJCovfNagBwWrTRAlwoT8THD-rYGJk0N1jvskaDbMeMQ_CSSPojM6HCTikqOBdESdsLLYQTQmeBluzbm5rHorcCFNXGPOitvPftA-RIitfMA40BAsq4B0Q42rEuIVcFcdjnpS6tUNZIFsP4pZUwrDvU5IiV6ininY7q90G9ECXa--D_ruM6PhGcF1twJ7rDUgWXBAoAVEgSkw9nWhR74DuH68nxDMn-Hjc_Y2qiTfDN20gb9BbYokLZ2r98sisPf_ngg6353bM3RGlyYKsDrvoSxnS6VcQ8fojF3hmfvNXSBcQpj85Ur9kkIzhqgyQWY0q3M5zD_UV9-kGNnkCWlxqv4XPloMZJ9sJ3a3oEPIYSoEtPlPX4UPzhthFTpDPo4kr99imF7RDZDBGkLDBwXP-QGEg0TcOr0ogCw7JTyLLzyFFYSk-LHLjcsRPWKo4Cj1dUDiEyE1bQEqUuRiFwlWfC7gGSTv3ZwCkfJ6TlaLTFPWf1ZEP9vFaKhRdDQ-V1mUICjYQ-lgR0GfLQ7AJksK7N55UqauyshvNSCykFrOteL_C7kg0-MahibMykh3wT4w";console.log("payload to send: ",{apikey:e,pin:"VKGGOQSE"});const i={accept:"application/json",Authorization:"Bearer "+l};console.log("headers to send: ",i);const n="/search?query="+o+"&type=series&language=eng&limit=5";this.$tvdb.get(n,{headers:i}).then(s=>{console.log("response.data.data: ",s.data.data),this.shows=s.data.data}).catch(s=>{console.log(s)})},addShow(o){console.log("In addShow, show: ",o);const e={id:o.id.replace("series-",""),name:o.name,year:o.year,image_url:o.image_url,thumbnail:o.thumbnail,overview:o.overview},l={authorization:sessionStorage.getItem("token")};this.$api.post("/api/add-show",e,{headers:l}).then(r=>{console.log("Response from server: ",r),console.log(this.myShowIDs),console.log("showToAdd.id: ",o.id),this.getMyShowIDs()}).catch(r=>{console.log("Error: ",r),this.logout()})},getMyShowIDs(){console.log("In getMyShowIDs");const o={authorization:sessionStorage.getItem("token")};this.$api.get("/api/get-my-show-ids",{headers:o}).then(e=>{console.log("get-my-show-ids response from server: ",e.data),this.myShowIDs=e.data,console.log("this.myShowIDs: ",this.myShowIDs)}).catch(e=>{console.log("Error: ",e),this.logout()})},inMyShows(o){const e=parseInt(o);return console.log("In inMyShows, showID: ",e),console.log(this.myShowIDs),this.myShowIDs!=-1&&this.myShowIDs.some(l=>l.show_id===e)?(console.log("showID is in myShowIDs"),!0):(console.log("showID is NOT in myShowIDs"),!1)},logout(){this.$hello.logout("facebook",{force:!0}),console.log("Session loggedIn now: "+sessionStorage.getItem("loggedIn")),sessionStorage.setItem("loggedIn","false"),this.$eventbus.emit("loggedIn","false"),console.log("Session loggedIn now: "+sessionStorage.getItem("loggedIn")),this.$router.push("/login")}}},L={class:"col"};function V(o,e,l,r,i,n){return c(),h(_,{class:"flex flex-top"},{default:t(()=>[p("div",L,[a(S,{filled:"",modelValue:i.showToFind,"onUpdate:modelValue":e[0]||(e[0]=s=>i.showToFind=s),label:"show to find"},null,8,["modelValue"]),a(d,{color:"primary",glossy:"",label:"Get back to my shows!",onClick:e[1]||(e[1]=s=>n.myShows()),style:{width:"100%"}}),a(C,{class:"bg-white",separator:"",bordered:""},{default:t(()=>[(c(!0),f(D,null,k(i.shows,s=>M((c(),h(Q,{key:s.name},{default:t(()=>[a(g,null,{default:t(()=>[a(u,null,{default:t(()=>[m(I(s.name),1)]),_:2},1024)]),_:2},1024),a(g,null,{default:t(()=>[a(u,null,{default:t(()=>[m(I(s.year),1)]),_:2},1024)]),_:2},1024),a(g,null,{default:t(()=>[n.inMyShows(s.id.replace("series-",""))?w("",!0):(c(),h(d,{key:0,onClick:J=>n.addShow(s),flat:"",rounded:"",color:"primary",icon:"bookmark_add"},null,8,["onClick"])),n.inMyShows(s.id.replace("series-",""))?(c(),h(d,{key:1,flat:"",rounded:"",color:"accent",icon:"bookmark_added"})):w("",!0)]),_:2},1024)]),_:2},1024)),[[b]])),128))]),_:1})])]),_:1})}var P=y(N,[["render",V]]);export{P as default};
